<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>LOFA ë³µì§€ê¸°ê¸ˆ íšŒì›ê°€ì…</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        body { background: #f0f2f5; display: flex; align-items: center; justify-content: center; min-height: 100vh; font-family: 'Malgun Gothic', sans-serif; padding: 20px 0; }
        .signup-card { background: white; padding: 40px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 100%; max-width: 500px; }
        .pw-msg { font-size: 0.8rem; margin-top: 5px; }
    </style>
</head>
<body>

<div class="signup-card shadow">
    <h3 class="text-center fw-bold text-primary mb-4"><i class="bi bi-person-check-fill"></i> ì§ì› íšŒì›ê°€ì…</h3>
    <form id="signupForm">
        <div class="mb-3">
            <label class="form-label fw-bold">ì‚¬ë²ˆ (ì•„ì´ë””)</label>
            <input type="text" name="employeeId" class="form-control" placeholder="ì‚¬ë²ˆì„ ì…ë ¥í•˜ì„¸ìš”" required>
        </div>
        
        <div class="mb-3">
            <label class="form-label fw-bold">ë¹„ë°€ë²ˆí˜¸</label>
            <input type="password" id="pw1" name="password" class="form-control" placeholder="ë¹„ë°€ë²ˆí˜¸ ì„¤ì •" required>
        </div>
        
        <div class="mb-3">
            <label class="form-label fw-bold">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
            <input type="password" id="pw2" class="form-control" placeholder="ë¹„ë°€ë²ˆí˜¸ ì¬ì…ë ¥" required>
            <div id="pwMatchMsg" class="pw-msg"></div> </div>

        <hr>
        
        <div class="row mb-3">
            <div class="col">
                <label class="form-label fw-bold">ì„±ëª…</label>
                <input type="text" name="userName" class="form-control" required>
            </div>
            <div class="col">
                <label class="form-label fw-bold">ì§ê¸‰</label>
                <select name="position" class="form-select" required>
                    <option value="">-- ì„ íƒ --</option>
                    <option value="ì‚¬ì›">ì‚¬ì›</option>
                    <option value="ì£¼ì„">ì£¼ì„</option>
                    <option value="ëŒ€ë¦¬">ëŒ€ë¦¬</option>
                    <option value="ê³¼ì¥">ê³¼ì¥</option>
                    <option value="ì°¨ì¥">ì°¨ì¥</option>
                    <option value="ë¶€ì¥">ë¶€ì¥</option>
                    <option value="íŒ€ì¥">íŒ€ì¥</option>
                    <option value="ì²˜ì¥">ì²˜ì¥</option>
                    <option value="ì´ì‚¬">ì´ì‚¬</option>
                    <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                </select>
            </div>
        </div>
        <div class="mb-3">
            <label class="form-label fw-bold">í•¸ë“œí° ë²ˆí˜¸</label>
            <input type="text" id="phoneInput" name="phone" class="form-control" placeholder="010-0000-0000" inputmode="numeric" maxlength="13" required>
        </div>
        <div class="mb-3">
            <label class="form-label fw-bold">ë¶€ì„œëª…</label>
            <input type="text" name="department" class="form-control" placeholder="ì˜ˆ: ê²½ì˜ì§€ì›ë¶€" required>
        </div>
        <div class="mb-3">
            <label class="form-label fw-bold">ì´ë©”ì¼ ì£¼ì†Œ</label>
            <input type="email" name="email" class="form-control" placeholder="example@gmail.com" required>
            <div class="form-text">ìŠ¹ì¸/ë°˜ë ¤ ê²°ê³¼ê°€ ì´ ë©”ì¼ë¡œ ë°œì†¡ë©ë‹ˆë‹¤.</div>
        </div>
        <div class="mb-3">
            <label class="form-label fw-bold">ì…ì‚¬ì¼</label>
            <input type="date" name="joinDate" class="form-control" required>
        </div>

        <div class="mb-4">
            <label class="form-label fw-bold small"><i class="bi bi-shield-lock"></i> ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš© ë™ì˜</label>
            <div class="card border-0 shadow-sm">
                <div class="card-body bg-light small" style="max-height: 120px; overflow-y: auto; font-size: 0.8rem;">
                    <p class="fw-bold mb-1">[ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©ì— ëŒ€í•œ ë™ì˜]</p>
                    <p class="mb-2">LOFA ë³µì§€ê¸°ê¸ˆ ì‹œìŠ¤í…œ íšŒì›ê°€ì…ì„ ìœ„í•´ ì•„ë˜ì™€ ê°™ì´ ê°œì¸ì •ë³´ë¥¼ ìˆ˜ì§‘ ë° ì´ìš©í•©ë‹ˆë‹¤.</p>
                    <ul class="ps-3 mb-2">
                        <li><strong>ìˆ˜ì§‘í•­ëª©:</strong> ì‚¬ë²ˆ, ë¹„ë°€ë²ˆí˜¸, ì„±ëª…, ì§ê¸‰, í•¸ë“œí° ë²ˆí˜¸, ë¶€ì„œëª…, ì…ì‚¬ì¼</li>
                        <li><strong>ìˆ˜ì§‘ëª©ì :</strong> ì‚¬ìš©ì ì‹ë³„ ë° ë³¸ì¸ í™•ì¸, ë³µì§€ ì„œë¹„ìŠ¤ ì œê³µ, ê³µì§€ì‚¬í•­ ì „ë‹¬</li>
                        <li><strong>ë³´ìœ ê¸°ê°„:</strong> íšŒì› íƒˆí‡´ ì‹œ ë˜ëŠ” ê·¼ë¡œê´€ê³„ ì¢…ë£Œ ì‹œê¹Œì§€</li>
                    </ul>
                    <p class="mb-0 text-muted">â€» ë™ì˜ë¥¼ ê±°ë¶€í•  ê¶Œë¦¬ê°€ ìˆìœ¼ë‚˜, ê±°ë¶€ ì‹œ íšŒì›ê°€ì… ë° ì„œë¹„ìŠ¤ ì´ìš©ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
                </div>
                <div class="card-footer bg-white py-2">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="privacyConsent" name="privacy_consent" required>
                        <label class="form-check-label small fw-bold" for="privacyConsent">
                            ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©ì— ë™ì˜í•©ë‹ˆë‹¤. (í•„ìˆ˜)
                        </label>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="d-grid gap-2">
            <button type="submit" class="btn btn-primary fw-bold p-2">ê°€ì…í•˜ê¸°</button>
            <a href="/" class="btn btn-outline-secondary btn-sm">ë¡œê·¸ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
        </div>
    </form>
</div>

<script>
    // ì „í™”ë²ˆí˜¸ ìë™ í¬ë§· (010-XXXX-XXXX)
    document.getElementById('phoneInput').addEventListener('input', function() {
        let v = this.value.replace(/[^0-9]/g, '');
        if (v.length <= 3) {
            this.value = v;
        } else if (v.length <= 7) {
            this.value = v.slice(0,3) + '-' + v.slice(3);
        } else {
            this.value = v.slice(0,3) + '-' + v.slice(3,7) + '-' + v.slice(7,11);
        }
    });

    const pw1 = document.getElementById('pw1');
    const pw2 = document.getElementById('pw2');
    const msg = document.getElementById('pwMatchMsg');

    // ğŸ’¡ ë¹„ë°€ë²ˆí˜¸ ì¼ì¹˜ ì‹¤ì‹œê°„ ì²´í¬
    function checkPassword() {
        if (pw2.value === "") {
            msg.innerHTML = "";
        } else if (pw1.value === pw2.value) {
            msg.innerHTML = "<i class='bi bi-check-circle'></i> ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤.";
            msg.style.color = "green";
        } else {
            msg.innerHTML = "<i class='bi bi-x-circle'></i> ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.";
            msg.style.color = "red";
        }
    }

    pw1.addEventListener('keyup', checkPassword);
    pw2.addEventListener('keyup', checkPassword);

    document.getElementById('signupForm').onsubmit = async (e) => {
        e.preventDefault();

        // ğŸ’¡ ì œì¶œ ì „ ë¹„ë°€ë²ˆí˜¸ ìµœì¢… í™•ì¸
        if (pw1.value !== pw2.value) {
            alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì„œë¡œ ë‹¤ë¦…ë‹ˆë‹¤. ë‹¤ì‹œ í™•ì¸í•´ ì£¼ì„¸ìš”.');
            pw2.focus();
            return;
        }

        const formData = new FormData(e.target);
        
        try {
            const res = await fetch('/signup_process', { method: 'POST', body: formData });
            const result = await res.json();
            if (result.status === 'success') {
                alert('íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ë¡œê·¸ì¸í•´ ì£¼ì„¸ìš”.');
                location.href = '/';
            } else {
                alert('ê°€ì… ì‹¤íŒ¨: ' + result.message);
            }
        } catch (err) {
            alert('ì„œë²„ì™€ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
    };
</script>
</body>
</html>