<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>LOFA ë³µì§€ê¸°ê¸ˆ íšŒì›ê°€ì…</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        body { background: #f0f2f5; display: flex; align-items: center; justify-content: center; min-height: 100vh; font-family: 'Malgun Gothic', sans-serif; padding: 20px 0; }
        .signup-card { background: white; padding: 40px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 100%; max-width: 500px; }
        .pw-msg { font-size: 0.8rem; margin-top: 5px; }
    </style>
</head>
<body>

<div class="signup-card shadow">
    <h3 class="text-center fw-bold text-primary mb-4"><i class="bi bi-person-check-fill"></i> ì§ì› íšŒì›ê°€ì…</h3>
    <form id="signupForm">
        <div class="mb-3">
            <label class="form-label fw-bold">ì‚¬ë²ˆ (ì•„ì´ë””)</label>
            <input type="text" name="employeeId" class="form-control" placeholder="ì‚¬ë²ˆì„ ì…ë ¥í•˜ì„¸ìš”" required>
        </div>
        
        <div class="mb-3">
            <label class="form-label fw-bold">ë¹„ë°€ë²ˆí˜¸</label>
            <input type="password" id="pw1" name="password" class="form-control" placeholder="ë¹„ë°€ë²ˆí˜¸ ì„¤ì •" required>
        </div>
        
        <div class="mb-3">
            <label class="form-label fw-bold">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
            <input type="password" id="pw2" class="form-control" placeholder="ë¹„ë°€ë²ˆí˜¸ ì¬ì…ë ¥" required>
            <div id="pwMatchMsg" class="pw-msg"></div> </div>

        <hr>
        
        <div class="row mb-3">
            <div class="col">
                <label class="form-label fw-bold">ì„±ëª…</label>
                <input type="text" name="userName" class="form-control" required>
            </div>
            <div class="col">
                <label class="form-label fw-bold">ì§ê¸‰</label>
                <input type="text" name="position" class="form-control" placeholder="ì˜ˆ: ì°¨ì¥" required>
            </div>
        </div>
        <div class="mb-3">
            <label class="form-label fw-bold">ë¶€ì„œëª…</label>
            <input type="text" name="department" class="form-control" placeholder="ì˜ˆ: ê²½ì˜ì§€ì›ë¶€" required>
        </div>
        <div class="mb-3">
            <label class="form-label fw-bold">ì…ì‚¬ì¼</label>
            <input type="date" name="joinDate" class="form-control" required>
        </div>
        
        <div class="d-grid gap-2">
            <button type="submit" class="btn btn-primary fw-bold p-2">ê°€ì…í•˜ê¸°</button>
            <a href="/" class="btn btn-outline-secondary btn-sm">ë¡œê·¸ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
        </div>
    </form>
</div>

<script>
    const pw1 = document.getElementById('pw1');
    const pw2 = document.getElementById('pw2');
    const msg = document.getElementById('pwMatchMsg');

    // ğŸ’¡ ë¹„ë°€ë²ˆí˜¸ ì¼ì¹˜ ì‹¤ì‹œê°„ ì²´í¬
    function checkPassword() {
        if (pw2.value === "") {
            msg.innerHTML = "";
        } else if (pw1.value === pw2.value) {
            msg.innerHTML = "<i class='bi bi-check-circle'></i> ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤.";
            msg.style.color = "green";
        } else {
            msg.innerHTML = "<i class='bi bi-x-circle'></i> ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.";
            msg.style.color = "red";
        }
    }

    pw1.addEventListener('keyup', checkPassword);
    pw2.addEventListener('keyup', checkPassword);

    document.getElementById('signupForm').onsubmit = async (e) => {
        e.preventDefault();

        // ğŸ’¡ ì œì¶œ ì „ ë¹„ë°€ë²ˆí˜¸ ìµœì¢… í™•ì¸
        if (pw1.value !== pw2.value) {
            alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì„œë¡œ ë‹¤ë¦…ë‹ˆë‹¤. ë‹¤ì‹œ í™•ì¸í•´ ì£¼ì„¸ìš”.');
            pw2.focus();
            return;
        }

        const formData = new FormData(e.target);
        
        try {
            const res = await fetch('/signup_process', { method: 'POST', body: formData });
            const result = await res.json();
            if (result.status === 'success') {
                alert('íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ë¡œê·¸ì¸í•´ ì£¼ì„¸ìš”.');
                location.href = '/';
            } else {
                alert('ê°€ì… ì‹¤íŒ¨: ' + result.message);
            }
        } catch (err) {
            alert('ì„œë²„ì™€ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
    };
</script>
</body>
</html>